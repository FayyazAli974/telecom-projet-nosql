{"paragraphs":[{"text":"%md\n## Jeu de donnees\nThe Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d'information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.\n\n\nCette base de données a eu beaucoup d'utilisations, par exemple pour mieux comprendre l'évolution et l'impact de la crise financière du 2008 (https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian dynamic financial networks with time-varying predictors]) ou analyser l'évolution des relations entre des pays impliquées dans des conflits (http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).\n\nGDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:\n\n* les events (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema], http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO Ontology], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* les mentions (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* le graph des relations => GKG, Global Knowledge Graph (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema], http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation])\n\nL'ensemble des donnees _GDELT_ sont disponibles via HTTP. Un fichier CSV _masterfilelist.txt_\n(http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master CSV data file list]) nous permmet d'avoir la liste de tous les fichiers du jeu de donnees GDELT ainsi que l'URL pour telecharger chaque fichier.\n\n\nPour plus d'infos sur le format des fichiers vous pouvez consulter la documentation GDELT: https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\n","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Jeu de donnees</h2>\n<p>The Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d&rsquo;information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.</p>\n<p>Cette base de données a eu beaucoup d&rsquo;utilisations, par exemple pour mieux comprendre l&rsquo;évolution et l&rsquo;impact de la crise financière du 2008 (<a href=\"https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian\">https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian</a> dynamic financial networks with time-varying predictors]) ou analyser l&rsquo;évolution des relations entre des pays impliquées dans des conflits (<a href=\"http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive\">http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive</a> Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).</p>\n<p>GDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:</p>\n<ul>\n  <li>les events (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO\">http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO</a> Ontology], <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>les mentions (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>le graph des relations =&gt; GKG, Global Knowledge Graph (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]</a>)</li>\n</ul>\n<p>L&rsquo;ensemble des donnees <em>GDELT</em> sont disponibles via HTTP. Un fichier CSV <em>masterfilelist.txt</em><br/>(<a href=\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master\">http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master</a> CSV data file list]) nous permmet d&rsquo;avoir la liste de tous les fichiers du jeu de donnees GDELT ainsi que l&rsquo;URL pour telecharger chaque fichier.</p>\n<p>Pour plus d&rsquo;infos sur le format des fichiers vous pouvez consulter la documentation GDELT: <a href=\"https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\">https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965360_-1717981194","id":"20181212-100610_115068599","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7944"},{"text":"%md\nDans ce notebook nous allons telecharger les fichiers GDELT pour la journee de 1er decembre 2018.\nOn commence par definir une function *fileDownloder* qui telecharge un fichier a partir d'un URL.","user":"anonymous","dateUpdated":"2020-01-17T09:06:54+0000","config":{"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Dans ce notebook nous allons telecharger les fichiers GDELT pour la journee de 1er decembre 2018.<br/>On commence par definir une function <em>fileDownloder</em> qui telecharge un fichier a partir d&rsquo;un URL.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965367_-66465653","id":"20181212-100702_1116690996","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T09:06:54+0000","dateFinished":"2020-01-17T09:06:54+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7945"},{"text":"%md\n## Chargement du fichier master dans S3","user":"anonymous","dateUpdated":"2020-01-17T09:07:08+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Chargement du fichier master dans S3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579251915173_-935763862","id":"20200117-090515_593668969","dateCreated":"2020-01-17T09:05:15+0000","dateStarted":"2020-01-17T09:06:59+0000","dateFinished":"2020-01-17T09:06:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7946"},{"text":"import spark.implicits._\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._\n\n\ndef fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","user":"anonymous","dateUpdated":"2020-01-17T10:40:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one feature warning; re-run with -feature for details\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]},"apps":[],"jobName":"paragraph_1579247965368_-1411534894","id":"20181209-161931_737140067","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T07:59:35+0000","dateFinished":"2020-01-17T08:00:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7947"},{"text":"%md\nOn peut tester cette function pour telecharger en local le *masterfilelist* GDELT. Sur quelle machine ce fichier sera stocque ? ","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut tester cette function pour telecharger en local le <em>masterfilelist</em> GDELT. Sur quelle machine ce fichier sera stocque ?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965368_-452532327","id":"20181212-101024_1671681559","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7948"},{"text":"fileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt\", \"/mnt/tmp/masterfilelist.txt\") // save the list file to the Spark Master","user":"anonymous","dateUpdated":"2020-01-17T08:00:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res1: Any = \"\"\n"}]},"apps":[],"jobName":"paragraph_1579247965369_544821548","id":"20181209-162121_1695304399","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:00:51+0000","dateFinished":"2020-01-17T08:00:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7949"},{"text":"%md\nOn peut verifier que le fichier a bien ete telecharge","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut verifier que le fichier a bien ete telecharge</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965371_699367138","id":"20181212-101108_352331024","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7950"},{"text":"%sh\nls -lrth /mnt/tmp |grep masterfilelist","user":"anonymous","dateUpdated":"2020-01-17T08:00:56+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-rw-r--r--  1 zeppelin zeppelin  53M Jan 17 08:00 masterfilelist.txt\n"}]},"apps":[],"jobName":"paragraph_1579247965371_-1977245965","id":"20181210-111357_801203770","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:00:56+0000","dateFinished":"2020-01-17T08:00:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7951"},{"text":"// Le code commenté est le code donné en cours. Il ne fonctionne pas, car il se base sur un ID et une clé AWS, d'un utilisateur qu'on devrait créer mais qu'on ne peut pas avec nos comptes educate. \n// Mettre l'id et la clé de notre compte root ne fonctionne pas non plus (je ne sais pas pourquoi). Le code non commenté fonctionne. Je pense que ce code utilise les infos de connexions du role que l'on utilise \n// actuellement (EMR_EC2_DefaultRole), et ce rôle a bien accès à S3, ou sinon de l'utilisateur root\n\n//import com.amazonaws.services.s3.AmazonS3Client\n//import com.amazonaws.auth.BasicAWSCredentials\n//import com.amazonaws.auth.DefaultAWSCredentialsProviderChain\n\n//val AWS_ID = \"ASIAZTSUL2OZIHFCANP5\"\n//val AWS_KEY = \"mS5tG/o8eWH12dtkkF9aeYuy3ZGar9rz4n6Q1zz8\"\n// la classe AmazonS3Client n'est pas serializable\n// on rajoute l'annotation @transient pour dire a Spark de ne pas essayer de serialiser cette classe et l'envoyer aux executeurs\n//@transient val awsClient = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n\n//sc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID) // mettre votre ID du fichier credentials.csv\n//sc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY) // mettre votre secret du fichier credentials.csv\n\n\nimport com.amazonaws.services.s3.AmazonS3ClientBuilder\nimport com.amazonaws.services.s3.AmazonS3;\n\n@transient val awsClient = AmazonS3ClientBuilder.standard().withRegion(\"us-east-1\").build();\nawsClient.putObject(\"inf728-projet\", \"masterfilelist.txt\", new File( \"/mnt/tmp/masterfilelist.txt\") )\n","user":"anonymous","dateUpdated":"2020-01-17T08:17:42+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.amazonaws.services.s3.AmazonS3ClientBuilder\nimport com.amazonaws.services.s3.AmazonS3\nawsClient: com.amazonaws.services.s3.AmazonS3 = com.amazonaws.services.s3.AmazonS3Client@111242a8\nres16: com.amazonaws.services.s3.model.PutObjectResult = com.amazonaws.services.s3.model.PutObjectResult@e4c7df4\n"}]},"apps":[],"jobName":"paragraph_1579247965375_1733638666","id":"20181212-095117_1356104178","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:17:42+0000","dateFinished":"2020-01-17T08:17:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7952"},{"text":"%md Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965379_-856194550","id":"20181212-101258_954978327","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7953"},{"text":"import org.apache.spark.sql.SQLContext\n\nval sqlContext = new SQLContext(sc)\nval filesDF = sqlContext.read.\n                    option(\"delimiter\",\" \").\n                    option(\"infer_schema\",\"true\").\n                    csv(\"s3://inf728-projet/masterfilelist.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\").\n                    cache","user":"anonymous","dateUpdated":"2020-01-17T08:02:18+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport org.apache.spark.sql.SQLContext\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@645b8d61\nfilesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1579247965380_130987347","id":"20181209-163052_14263535","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:02:18+0000","dateFinished":"2020-01-17T08:02:37+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7954"},{"text":"filesDF.show(false)","user":"anonymous","dateUpdated":"2020-01-17T08:02:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------------------+--------------------------------------------------------------------+\n|size    |hash                            |url                                                                 |\n+--------+--------------------------------+--------------------------------------------------------------------+\n|150383  |297a16b493de7cf6ca809a7cc31d0b93|http://data.gdeltproject.org/gdeltv2/20150218230000.export.CSV.zip  |\n|318084  |bb27f78ba45f69a17ea6ed7755e9f8ff|http://data.gdeltproject.org/gdeltv2/20150218230000.mentions.CSV.zip|\n|10768507|ea8dde0beb0ba98810a92db068c0ce99|http://data.gdeltproject.org/gdeltv2/20150218230000.gkg.csv.zip     |\n|149211  |2a91041d7e72b0fc6a629e2ff867b240|http://data.gdeltproject.org/gdeltv2/20150218231500.export.CSV.zip  |\n|339037  |dec3f427076b716a8112b9086c342523|http://data.gdeltproject.org/gdeltv2/20150218231500.mentions.CSV.zip|\n|10269336|2f1a504a3c4558694ade0442e9a5ae6f|http://data.gdeltproject.org/gdeltv2/20150218231500.gkg.csv.zip     |\n|149723  |12268e821823aae2da90882621feda18|http://data.gdeltproject.org/gdeltv2/20150218233000.export.CSV.zip  |\n|357229  |744acad14559f2781a8db67715d63872|http://data.gdeltproject.org/gdeltv2/20150218233000.mentions.CSV.zip|\n|11279827|66b03e2efd7d51dabf916b1666910053|http://data.gdeltproject.org/gdeltv2/20150218233000.gkg.csv.zip     |\n|158842  |a5298ce3c6df1a8a759c61b5c0b6f8bb|http://data.gdeltproject.org/gdeltv2/20150218234500.export.CSV.zip  |\n|374528  |dd322c888f28311aca2c735468405551|http://data.gdeltproject.org/gdeltv2/20150218234500.mentions.CSV.zip|\n|11212939|cd20f295649b214dd16666ca451b9994|http://data.gdeltproject.org/gdeltv2/20150218234500.gkg.csv.zip     |\n|362610  |c4268d558bb22c02b3c132c17818c68b|http://data.gdeltproject.org/gdeltv2/20150219000000.export.CSV.zip  |\n|287807  |e7f464a7a451ad2af6e9c8fa24f0ccea|http://data.gdeltproject.org/gdeltv2/20150219000000.mentions.CSV.zip|\n|9728953 |8f4b26e134bd6605cce2d32e92e5d3d7|http://data.gdeltproject.org/gdeltv2/20150219000000.gkg.csv.zip     |\n|251605  |7685a6c71f010918f3be0d4ed2be977e|http://data.gdeltproject.org/gdeltv2/20150219001500.export.CSV.zip  |\n|263793  |e23ee65a60a1577dc74b979a54da406e|http://data.gdeltproject.org/gdeltv2/20150219001500.mentions.CSV.zip|\n|9459370 |6031464dfdcb331551d491916d400c18|http://data.gdeltproject.org/gdeltv2/20150219001500.gkg.csv.zip     |\n|255259  |f41066efb05d4024fca9dc1c2c6b9112|http://data.gdeltproject.org/gdeltv2/20150219003000.export.CSV.zip  |\n|308019  |061133d1efd29c66c7ecba0d52063927|http://data.gdeltproject.org/gdeltv2/20150219003000.mentions.CSV.zip|\n+--------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579247965381_1308463541","id":"20181209-185148_142944415","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:02:41+0000","dateFinished":"2020-01-17T08:02:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7955"},{"text":"%md\n## Chargement des fichiers d'une journée dans S3","user":"anonymous","dateUpdated":"2020-01-17T09:33:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Chargement des fichiers d&rsquo;une journée dans S3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579252161115_-1510573628","id":"20200117-090921_1088801383","dateCreated":"2020-01-17T09:09:21+0000","dateStarted":"2020-01-17T09:33:40+0000","dateFinished":"2020-01-17T09:33:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7956"},{"text":"%md Par la suite on va charger uniquement les fichiers qui correspondent a la journee du 1er decembre 2018","user":"anonymous","dateUpdated":"2020-01-17T09:34:04+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Par la suite on va charger uniquement les fichiers qui correspondent a la journee du 1er decembre 2018</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965381_423392689","id":"20181212-101345_616653479","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T09:34:04+0000","dateFinished":"2020-01-17T09:34:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7957"},{"text":"val sampleDF = filesDF.filter(col(\"url\").contains(\"/20181201\")).cache\n","user":"anonymous","dateUpdated":"2020-01-17T08:06:05+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sampleDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1579247965384_679878335","id":"20181209-162427_816541907","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:02:49+0000","dateFinished":"2020-01-17T08:02:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7958"},{"text":"sampleDF.show(false)","user":"anonymous","dateUpdated":"2020-01-17T08:02:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------------------+--------------------------------------------------------------------+\n|size    |hash                            |url                                                                 |\n+--------+--------------------------------+--------------------------------------------------------------------+\n|286749  |7745b74ca805d90a86a19909a67e410a|http://data.gdeltproject.org/gdeltv2/20181201000000.export.CSV.zip  |\n|249784  |95ea33b0393a85214eebfa58a02ceb38|http://data.gdeltproject.org/gdeltv2/20181201000000.mentions.CSV.zip|\n|9694304 |c0a3d85a1f3a5263b4c9f7ee1aa632f7|http://data.gdeltproject.org/gdeltv2/20181201000000.gkg.csv.zip     |\n|250319  |47317d0bd9cd56e7b96732677a918435|http://data.gdeltproject.org/gdeltv2/20181201001500.export.CSV.zip  |\n|304863  |37513cccbabc99a9e50a36dc8a590cb6|http://data.gdeltproject.org/gdeltv2/20181201001500.mentions.CSV.zip|\n|10119350|50c3fa1e60385a2ca1314af48dfbad4f|http://data.gdeltproject.org/gdeltv2/20181201001500.gkg.csv.zip     |\n|224825  |8ca8b3a6b4ff6a960b8db5ac8eb9174a|http://data.gdeltproject.org/gdeltv2/20181201003000.export.CSV.zip  |\n|298101  |68369aec62706a2b5a3752d2d725caa9|http://data.gdeltproject.org/gdeltv2/20181201003000.mentions.CSV.zip|\n|9705075 |8cd7aa2af725aa02b42412e0944cfe26|http://data.gdeltproject.org/gdeltv2/20181201003000.gkg.csv.zip     |\n|191077  |906e6599092855ba2965fe59fce70062|http://data.gdeltproject.org/gdeltv2/20181201004500.export.CSV.zip  |\n|252312  |de9048e047049b3b6ac86c0029caeb9c|http://data.gdeltproject.org/gdeltv2/20181201004500.mentions.CSV.zip|\n|9370422 |5a674db2a8d110d27753b97617431688|http://data.gdeltproject.org/gdeltv2/20181201004500.gkg.csv.zip     |\n|187888  |cee25cd1ab712b7ac4e2538c48353f21|http://data.gdeltproject.org/gdeltv2/20181201010000.export.CSV.zip  |\n|274338  |e12ffacb37d73d9c9470a93032a50f41|http://data.gdeltproject.org/gdeltv2/20181201010000.mentions.CSV.zip|\n|10008236|48764cfe5bc415441ed34b4b5a1b0372|http://data.gdeltproject.org/gdeltv2/20181201010000.gkg.csv.zip     |\n|145719  |df1010eb1a3466fef5c9a5b89368328c|http://data.gdeltproject.org/gdeltv2/20181201011500.export.CSV.zip  |\n|255772  |781fffb723e8b5595fc08517ccc6c91b|http://data.gdeltproject.org/gdeltv2/20181201011500.mentions.CSV.zip|\n|8933180 |e1fa1f13da14b85e2ba31c35cbbac8b1|http://data.gdeltproject.org/gdeltv2/20181201011500.gkg.csv.zip     |\n|133461  |1bcaee75fe0a316dac205752030a05e5|http://data.gdeltproject.org/gdeltv2/20181201013000.export.CSV.zip  |\n|246396  |2c9bac79d58fc5a141651ddc072d0cd6|http://data.gdeltproject.org/gdeltv2/20181201013000.mentions.CSV.zip|\n+--------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579247965384_-1856358751","id":"20181209-184529_2045997321","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:02:52+0000","dateFinished":"2020-01-17T08:02:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7959"},{"text":"%md Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965386_-2067950908","id":"20181212-101426_1390220831","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7960"},{"text":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\n\nobject AwsClient{\n    val s3 = new AmazonS3Client()\n}\n\n\nsampleDF.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"inf728-projet\", fileName, localFile )\n            //awsClient.putObject(\"inf728-projet\", fileName, localFile )\n            localFile.delete()\n})","user":"anonymous","dateUpdated":"2020-01-17T09:35:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\ndefined object AwsClient\n"}]},"apps":[],"jobName":"paragraph_1579247965386_1730706397","id":"20181209-163933_1336720866","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T09:03:30+0000","dateFinished":"2020-01-17T09:03:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7961"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579257742235_288972455","id":"20200117-104222_595501095","dateCreated":"2020-01-17T10:42:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11305","text":"%md\n## Chargement des données dans un dataframe","dateUpdated":"2020-01-17T10:45:05+0000","dateFinished":"2020-01-17T10:45:05+0000","dateStarted":"2020-01-17T10:45:05+0000","results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Chargement des données dans un dataframe</h2>\n</div>"}]}},{"text":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n\nval textRDD = sc.binaryFiles(\"s3://inf728-projet/20181201[0-9]*.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n\ntextRDD.take(1)","user":"anonymous","dateUpdated":"2020-01-17T09:37:19+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\ntextRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[191] at flatMap at <console>:74\nres34: Array[String] = Array(806754250\t20171201\t201712\t2017\t2017.9068\t\t\t\t\t\t\t\t\t\t\tUSA\tUNITED STATES\tUSA\t\t\t\t\t\t\t\t1\t100\t100\t10\t3\t-5.0\t4\t1\t4\t-0.66666666666667\t0\t\t\t\t\t\t\t\t3\tNew Haven, Connecticut, United States\tUS\tUSCT\t\t41.3082\t-72.9282\t209231\t3\tNew Haven, Connecticut, United States\tUS\tUSCT\t\t41.3082\t-72.9282\t209231\t20181201000000\thttps://bismarcktribune.com/news/national/the-latest-immigrant-s-supporters-end-courthouse-protest/article_76d71ef6-d0e0-5e02-ab72-4c8a0d31778e.html)\n"}]},"apps":[],"jobName":"paragraph_1579253794654_1541271188","id":"20200117-093634_466317294","dateCreated":"2020-01-17T09:36:34+0000","dateStarted":"2020-01-17T09:37:19+0000","dateFinished":"2020-01-17T09:37:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7962"},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579257524180_-1036528829","id":"20200117-103844_729873588","dateCreated":"2020-01-17T10:38:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:11172","text":"// Convert textRDD to dataframe\nval arrays = textRDD.map(_.split(\"\\t\")) \nval maxCols = arrays.first().length\nval textDF = arrays.toDF(\"arr\")\n  .select((0 until maxCols).map(i => $\"arr\"(i).as(s\"col_$i\")): _*)\n\ntextDF.show()","dateUpdated":"2020-01-17T10:41:02+0000","dateFinished":"2020-01-17T10:41:04+0000","dateStarted":"2020-01-17T10:41:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\n|    col_0|   col_1| col_2|col_3|    col_4| col_5|        col_6|col_7|col_8|col_9|col_10|col_11|col_12|col_13|col_14|col_15|       col_16|col_17|col_18|col_19|col_20|col_21|col_22|col_23|col_24|col_25|col_26|col_27|col_28|col_29|col_30|col_31|col_32|col_33|           col_34|col_35|              col_36|col_37|col_38|col_39|  col_40|  col_41|  col_42|col_43|              col_44|col_45|col_46|col_47|  col_48|  col_49|  col_50|col_51|              col_52|col_53|col_54|col_55|  col_56|  col_57|  col_58|        col_59|              col_60|\n+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\n|806754250|20171201|201712| 2017|2017.9068|      |             |     |     |     |      |      |      |      |      |   USA|UNITED STATES|   USA|      |      |      |      |      |      |      |     1|   100|   100|    10|     3|  -5.0|     4|     1|     4|-0.66666666666667|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754251|20171201|201712| 2017|2017.9068|      |             |     |     |     |      |      |      |      |      |   USA|UNITED STATES|   USA|      |      |      |      |      |      |      |     1|   174|   174|    17|     4|  -5.0|     4|     1|     4|-0.66666666666667|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754252|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     1|     1|     1|-3.40091563113146|     4|Malvinas, TucumáA...|    AR|  AR24|  4883|-26.9167|-65.2833|-1003014|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://www.nbcmi...|\n|806754253|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     3|     3|     3|-2.98160973367665|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|20181201000000|https://m.lasvega...|\n|806754254|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     2|     2|     2|-2.77195678494925|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://m.lasvega...|\n|806754255|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   FRA|       FRANCE|   FRA|      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     4|     1|     4|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|              France|    FR|    FR|      |      46|       2|      FR|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754256|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   FRA|       FRANCE|   FRA|      |      |      |      |      |      |      |     1|   173|   173|    17|     4|  -5.0|     4|     1|     4|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|              France|    FR|    FR|      |      46|       2|      FR|     1|              France|    FR|    FR|      |      46|       2|      FR|20181201000000|https://www.stuff...|\n|806754257|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   GBR|      BRITAIN|   GBR|      |      |      |      |      |      |      |     1|   042|   042|    04|     1|   1.9|     6|     1|     6|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|      United Kingdom|    UK|    UK|      |      54|      -4|      UK|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754258|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     3|     3|     3|-2.98160973367665|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|20181201000000|https://m.lasvega...|\n|806754259|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     1|     1|     1|-3.40091563113146|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Malvinas, TucumáA...|    AR|  AR24|  4883|-26.9167|-65.2833|-1003014|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://www.nbcmi...|\n|806754260|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     2|     2|     2|-2.77195678494925|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://m.lasvega...|\n|806754261|20171201|201712| 2017|2017.9068|   FRA|       FRANCE|  FRA|     |     |      |      |      |      |      |   AUS|       SYDNEY|   AUS|      |      |      |      |      |      |      |     1|   042|   042|    04|     1|   1.9|     4|     1|     4|-6.80272108843537|     1|              France|    FR|    FR|      |      46|       2|      FR|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754262|20171201|201712| 2017|2017.9068|   GBR|      BRITAIN|  GBR|     |     |      |      |      |      |      |   AUS|       SYDNEY|   AUS|      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     6|     1|     6|-6.80272108843537|     1|      United Kingdom|    UK|    UK|      |      54|      -4|      UK|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754263|20171201|201712| 2017|2017.9068|MEXGOV|      MEXICAN|  MEX|     |     |      |      |   GOV|      |      |   EDU|      COLLEGE|      |      |      |      |      |   EDU|      |      |     0|   173|   173|    17|     4|  -5.0|     3|     1|     3|-7.66961651917404|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|20181201000000|https://napavalle...|\n|806754264|20171201|201712| 2017|2017.9068|MEXGOV|       MEXICO|  MEX|     |     |      |      |   GOV|      |      |   MEX|       MEXICO|   MEX|      |      |      |      |      |      |      |     0|   173|   173|    17|     4|  -5.0|     1|     1|     1|-7.66961651917404|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|20181201000000|https://napavalle...|\n|806754265|20171201|201712| 2017|2017.9068|MEXGOV|       MEXICO|  MEX|     |     |      |      |   GOV|      |      |   MEX|       MEXICO|   MEX|      |      |      |      |      |      |      |     0|   173|   173|    17|     4|  -5.0|     1|     1|     1|-7.66961651917404|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|20181201000000|https://napavalle...|\n|806754266|20171201|201712| 2017|2017.9068|   RUS|       RUSSIA|  RUS|     |     |      |      |      |      |      |LEGSPY|       SENATE|      |      |      |      |      |   LEG|   SPY|      |     1|   010|   010|    01|     1|   0.0|     2|     1|     2|-3.69068541300527|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|20181201000000|https://www.europ...|\n|806754267|20171201|201712| 2017|2017.9068|   USA| JACKSONVILLE|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     5|     1|     5|-1.09589041095891|     3|Jacksonville, Flo...|    US|  USFL| FL031| 30.3322|-81.6556|  295003|     0|                    |      |      |      |        |        |        |     2|Michigan, United ...|    US|  USMI|      | 43.3504|-84.5603|      MI|20181201000000|https://www.actio...|\n|806754268|20171201|201712| 2017|2017.9068|   USA|UNITED STATES|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     0|   100|   100|    10|     3|  -5.0|     4|     1|     4|-0.66666666666667|     3|New Haven, Connec...|    US|  USCT| CT009| 41.3082|-72.9282|  209231|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754269|20171201|201712| 2017|2017.9068|   USA|UNITED STATES|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     1|   129|   129|    12|     3|  -5.0|     4|     1|     4| 0.32467532467533|     2|South Carolina, U...|    US|  USSC|      | 33.8191|-80.9066|      SC|     0|                    |      |      |      |        |        |        |     2|South Carolina, U...|    US|  USSC|      | 33.8191|-80.9066|      SC|20181201000000|https://www.south...|\n+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\nonly showing top 20 rows\n\narrays: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[248] at map at <console>:81\nmaxCols: Int = 61\ntextDF: org.apache.spark.sql.DataFrame = [col_0: string, col_1: string ... 59 more fields]\n"}]}},{"text":"%md\n## Remplissage des tables Cassandra","user":"anonymous","dateUpdated":"2020-01-17T09:36:04+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Remplissage des tables Cassandra</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579253743694_39287356","id":"20200117-093543_438964787","dateCreated":"2020-01-17T09:35:43+0000","dateStarted":"2020-01-17T09:36:04+0000","dateFinished":"2020-01-17T09:36:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7965"},{"text":"// Add spark connector specific methods to Dataset\nimport com.datastax.spark.connector._","user":"anonymous","dateUpdated":"2020-01-17T09:04:41+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.datastax.spark.connector._\n"}]},"apps":[],"jobName":"paragraph_1579247965390_-1155882955","id":"20200114-150212_994586667","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T09:04:41+0000","dateFinished":"2020-01-17T09:04:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7966"},{"text":"val df = createDataFrame(rowRDD: RDD[Row], schema: StructType): DataFrame","user":"anonymous","dateUpdated":"2020-01-17T09:43:50+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579253919360_-421301527","id":"20200117-093839_1301683811","dateCreated":"2020-01-17T09:38:39+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:7967"},{"text":"%md\n## Brouillon","user":"anonymous","dateUpdated":"2020-01-17T09:35:36+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Brouillon</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579253724572_-703643389","id":"20200117-093524_1044203784","dateCreated":"2020-01-17T09:35:24+0000","dateStarted":"2020-01-17T09:35:36+0000","dateFinished":"2020-01-17T09:35:36+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7968"},{"text":"%sh\naws s3 ls","user":"anonymous","dateUpdated":"2020-01-17T08:00:59+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2020-01-12 19:33:56 aws-logs-660528157618-us-east-1\n2020-01-09 09:56:53 inf728-projet\n"}]},"apps":[],"jobName":"paragraph_1579247965372_-407919966","id":"20200112-201437_442754611","dateCreated":"2020-01-17T07:59:25+0000","dateStarted":"2020-01-17T08:00:59+0000","dateFinished":"2020-01-17T08:01:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:7969"},{"text":"%md\nWell done! Vous pouvez maintenaient explorer les donnees via le notebook gdeltExploration.json","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Well done! Vous pouvez maintenaient explorer les donnees via le notebook gdeltExploration.json</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247965393_680119938","id":"20181212-100557_635513911","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7970"},{"text":"%sh\naws sts get-caller-identity","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\n    \"Account\": \"660528157618\", \n    \"UserId\": \"AROAZTSUL2OZADPFFEGJV:i-09cb1ea84eb6235dc\", \n    \"Arn\": \"arn:aws:sts::660528157618:assumed-role/EMR_EC2_DefaultRole/i-09cb1ea84eb6235dc\"\n}\n"}]},"apps":[],"jobName":"paragraph_1579247965373_51709039","id":"20200112-202950_1447155640","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7971"},{"text":"%sh\naws configure list","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      Name                    Value             Type    Location\n      ----                    -----             ----    --------\n   profile                <not set>             None    None\naccess_key     ****************U56D         iam-role    \nsecret_key     ****************WLyd         iam-role    \n    region                <not set>             None    None\n"}]},"apps":[],"jobName":"paragraph_1579247965373_111967741","id":"20200112-210411_232637861","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7972"},{"text":"%sh\nwget http://central.maven.org/maven2/com/datastax/spark/spark-cassandra-connector_2.11/2.4.0/spark-cassandra-connector_2.11-2.4.0.jar;","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2020-01-14 23:32:34--  http://central.maven.org/maven2/com/datastax/spark/spark-cassandra-connector_2.11/2.4.0/spark-cassandra-connector_2.11-2.4.0.jar\nResolving central.maven.org (central.maven.org)... 151.101.248.209\nConnecting to central.maven.org (central.maven.org)|151.101.248.209|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 8540380 (8.1M) [application/java-archive]\nSaving to: ‘spark-cassandra-connector_2.11-2.4.0.jar’\n\n     0K .......... .......... .......... .......... ..........  0% 28.5M 0s\n    50K .......... .......... .......... .......... ..........  1% 60.3M 0s\n   100K .......... .......... .......... .......... ..........  1% 30.6M 0s\n   150K .......... .......... .......... .......... ..........  2% 53.9M 0s\n   200K .......... .......... .......... .......... ..........  2% 32.2M 0s\n   250K .......... .......... .......... .......... ..........  3% 53.9M 0s\n   300K .......... .......... .......... .......... ..........  4% 52.5M 0s\n   350K .......... .......... .......... .......... ..........  4% 53.6M 0s\n   400K .......... .......... .......... .......... ..........  5% 52.3M 0s\n   450K .......... .......... .......... .......... ..........  5% 57.5M 0s\n   500K .......... .......... .......... .......... ..........  6% 53.0M 0s\n   550K .......... .......... .......... .......... ..........  7% 53.3M 0s\n   600K .......... .......... .......... .......... ..........  7% 57.4M 0s\n   650K .......... .......... .......... .......... ..........  8% 55.3M 0s\n   700K .......... .......... .......... .......... ..........  8% 54.6M 0s\n   750K .......... .......... .......... .......... ..........  9% 44.3M 0s\n   800K .......... .......... .......... .......... .......... 10% 79.4M 0s\n   850K .......... .......... .......... .......... .......... 10%  116M 0s\n   900K .......... .......... .......... .......... .......... 11%  105M 0s\n   950K .......... .......... .......... .......... .......... 11% 60.4M 0s\n  1000K .......... .......... .......... .......... .......... 12%  114M 0s\n  1050K .......... .......... .......... .......... .......... 13% 58.9M 0s\n  1100K .......... .......... .......... .......... .......... 13% 57.2M 0s\n  1150K .......... .......... .......... .......... .......... 14% 49.8M 0s\n  1200K .......... .......... .......... .......... .......... 14% 46.0M 0s\n  1250K .......... .......... .......... .......... .......... 15% 47.7M 0s\n  1300K .......... .......... .......... .......... .......... 16% 47.9M 0s\n  1350K .......... .......... .......... .......... .......... 16%  112M 0s\n  1400K .......... .......... .......... .......... .......... 17% 60.2M 0s\n  1450K .......... .......... .......... .......... .......... 17% 77.0M 0s\n  1500K .......... .......... .......... .......... .......... 18%  172M 0s\n  1550K .......... .......... .......... .......... .......... 19%  186M 0s\n  1600K .......... .......... .......... .......... .......... 19%  431M 0s\n  1650K .......... .......... .......... .......... .......... 20%  432M 0s\n  1700K .......... .......... .......... .......... .......... 20%  373M 0s\n  1750K .......... .......... .......... .......... .......... 21%  249M 0s\n  1800K .......... .......... .......... .......... .......... 22%  303M 0s\n  1850K .......... .......... .......... .......... .......... 22% 53.7M 0s\n  1900K .......... .......... .......... .......... .......... 23%  164M 0s\n  1950K .......... .......... .......... .......... .......... 23%  290M 0s\n  2000K .......... .......... .......... .......... .......... 24%  179M 0s\n  2050K .......... .......... .......... .......... .......... 25%  208M 0s\n  2100K .......... .......... .......... .......... .......... 25%  210M 0s\n  2150K .......... .......... .......... .......... .......... 26%  104M 0s\n  2200K .......... .......... .......... .......... .......... 26%  171M 0s\n  2250K .......... .......... .......... .......... .......... 27%  294M 0s\n  2300K .......... .......... .......... .......... .......... 28%  121M 0s\n  2350K .......... .......... .......... .......... .......... 28%  242M 0s\n  2400K .......... .......... .......... .......... .......... 29%  284M 0s\n  2450K .......... .......... .......... .......... .......... 29% 52.9M 0s\n  2500K .......... .......... .......... .......... .......... 30%  205M 0s\n  2550K .......... .......... .......... .......... .......... 31%  174M 0s\n  2600K .......... .......... .......... .......... .......... 31%  137M 0s\n  2650K .......... .......... .......... .......... .......... 32%  373M 0s\n  2700K .......... .......... .......... .......... .......... 32% 85.2M 0s\n  2750K .......... .......... .......... .......... .......... 33%  265M 0s\n  2800K .......... .......... .......... .......... .......... 34% 11.4M 0s\n  2850K .......... .......... .......... .......... .......... 34%  282M 0s\n  2900K .......... .......... .......... .......... .......... 35%  293M 0s\n  2950K .......... .......... .......... .......... .......... 35% 97.2M 0s\n  3000K .......... .......... .......... .......... .......... 36%  117M 0s\n  3050K .......... .......... .......... .......... .......... 37%  121M 0s\n  3100K .......... .......... .......... .......... .......... 37%  295M 0s\n  3150K .......... .......... .......... .......... .......... 38%  283M 0s\n  3200K .......... .......... .......... .......... .......... 38%  243M 0s\n  3250K .......... .......... .......... .......... .......... 39% 27.9M 0s\n  3300K .......... .......... .......... .......... .......... 40% 70.2M 0s\n  3350K .......... .......... .......... .......... .......... 40% 64.1M 0s\n  3400K .......... .......... .......... .......... .......... 41% 67.0M 0s\n  3450K .......... .......... .......... .......... .......... 41% 40.9M 0s\n  3500K .......... .......... .......... .......... .......... 42% 69.1M 0s\n  3550K .......... .......... .......... .......... .......... 43%  124M 0s\n  3600K .......... .......... .......... .......... .......... 43%  291M 0s\n  3650K .......... .......... .......... .......... .......... 44%  304M 0s\n  3700K .......... .......... .......... .......... .......... 44%  318M 0s\n  3750K .......... .......... .......... .......... .......... 45% 64.6M 0s\n  3800K .......... .......... .......... .......... .......... 46% 71.1M 0s\n  3850K .......... .......... .......... .......... .......... 46% 69.6M 0s\n  3900K .......... .......... .......... .......... .......... 47% 71.4M 0s\n  3950K .......... .......... .......... .......... .......... 47% 60.8M 0s\n  4000K .......... .......... .......... .......... .......... 48% 65.9M 0s\n  4050K .......... .......... .......... .......... .......... 49%  102M 0s\n  4100K .......... .......... .......... .......... .......... 49% 59.3M 0s\n  4150K .......... .......... .......... .......... .......... 50% 91.4M 0s\n  4200K .......... .......... .......... .......... .......... 50% 61.6M 0s\n  4250K .......... .......... .......... .......... .......... 51% 64.9M 0s\n  4300K .......... .......... .......... .......... .......... 52% 82.5M 0s\n  4350K .......... .......... .......... .......... .......... 52% 17.8M 0s\n  4400K .......... .......... .......... .......... .......... 53%  151M 0s\n  4450K .......... .......... .......... .......... .......... 53%  290M 0s\n  4500K .......... .......... .......... .......... .......... 54%  311M 0s\n  4550K .......... .......... .......... .......... .......... 55%  270M 0s\n  4600K .......... .......... .......... .......... .......... 55% 54.1M 0s\n  4650K .......... .......... .......... .......... .......... 56% 35.5M 0s\n  4700K .......... .......... .......... .......... .......... 56% 67.7M 0s\n  4750K .......... .......... .......... .......... .......... 57% 71.5M 0s\n  4800K .......... .......... .......... .......... .......... 58% 19.9M 0s\n  4850K .......... .......... .......... .......... .......... 58% 48.4M 0s\n  4900K .......... .......... .......... .......... .......... 59%  297M 0s\n  4950K .......... .......... .......... .......... .......... 59%  311M 0s\n  5000K .......... .......... .......... .......... .......... 60%  312M 0s\n  5050K .......... .......... .......... .......... .......... 61%  273M 0s\n  5100K .......... .......... .......... .......... .......... 61%  307M 0s\n  5150K .......... .......... .......... .......... .......... 62% 35.6M 0s\n  5200K .......... .......... .......... .......... .......... 62% 66.5M 0s\n  5250K .......... .......... .......... .......... .......... 63% 62.7M 0s\n  5300K .......... .......... .......... .......... .......... 64% 67.3M 0s\n  5350K .......... .......... .......... .......... .......... 64% 66.3M 0s\n  5400K .......... .......... .......... .......... .......... 65% 67.4M 0s\n  5450K .......... .......... .......... .......... .......... 65% 60.0M 0s\n  5500K .......... .......... .......... .......... .......... 66% 61.5M 0s\n  5550K .......... .......... .......... .......... .......... 67%  147M 0s\n  5600K .......... .......... .......... .......... .......... 67%  267M 0s\n  5650K .......... .......... .......... .......... .......... 68%  129M 0s\n  5700K .......... .......... .......... .......... .......... 68% 63.0M 0s\n  5750K .......... .......... .......... .......... .......... 69% 70.0M 0s\n  5800K .......... .......... .......... .......... .......... 70% 62.3M 0s\n  5850K .......... .......... .......... .......... .......... 70% 69.5M 0s\n  5900K .......... .......... .......... .......... .......... 71% 68.4M 0s\n  5950K .......... .......... .......... .......... .......... 71% 68.8M 0s\n  6000K .......... .......... .......... .......... .......... 72% 57.6M 0s\n  6050K .......... .......... .......... .......... .......... 73%  116M 0s\n  6100K .......... .......... .......... .......... .......... 73% 65.5M 0s\n  6150K .......... .......... .......... .......... .......... 74% 67.3M 0s\n  6200K .......... .......... .......... .......... .......... 74% 69.7M 0s\n  6250K .......... .......... .......... .......... .......... 75% 70.9M 0s\n  6300K .......... .......... .......... .......... .......... 76% 75.8M 0s\n  6350K .......... .......... .......... .......... .......... 76% 16.9M 0s\n  6400K .......... .......... .......... .......... .......... 77%  148M 0s\n  6450K .......... .......... .......... .......... .......... 77%  257M 0s\n  6500K .......... .......... .......... .......... .......... 78%  303M 0s\n  6550K .......... .......... .......... .......... .......... 79%  287M 0s\n  6600K .......... .......... .......... .......... .......... 79% 74.6M 0s\n  6650K .......... .......... .......... .......... .......... 80% 60.9M 0s\n  6700K .......... .......... .......... .......... .......... 80% 69.9M 0s\n  6750K .......... .......... .......... .......... .......... 81% 68.2M 0s\n  6800K .......... .......... .......... .......... .......... 82% 71.1M 0s\n  6850K .......... .......... .......... .......... .......... 82% 62.3M 0s\n  6900K .......... .......... .......... .......... .......... 83% 71.9M 0s\n  6950K .......... .......... .......... .......... .......... 83%  110M 0s\n  7000K .......... .......... .......... .......... .......... 84% 21.7M 0s\n  7050K .......... .......... .......... .......... .......... 85% 93.5M 0s\n  7100K .......... .......... .......... .......... .......... 85% 75.5M 0s\n  7150K .......... .......... .......... .......... .......... 86% 69.9M 0s\n  7200K .......... .......... .......... .......... .......... 86% 84.6M 0s\n  7250K .......... .......... .......... .......... .......... 87% 91.7M 0s\n  7300K .......... .......... .......... .......... .......... 88% 81.2M 0s\n  7350K .......... .......... .......... .......... .......... 88% 82.4M 0s\n  7400K .......... .......... .......... .......... .......... 89% 64.4M 0s\n  7450K .......... .......... .......... .......... .......... 89%  150M 0s\n  7500K .......... .......... .......... .......... .......... 90%  146M 0s\n  7550K .......... .......... .......... .......... .......... 91% 69.8M 0s\n  7600K .......... .......... .......... .......... .......... 91% 61.7M 0s\n  7650K .......... .......... .......... .......... .......... 92% 81.8M 0s\n  7700K .......... .......... .......... .......... .......... 92% 65.9M 0s\n  7750K .......... .......... .......... .......... .......... 93% 73.2M 0s\n  7800K .......... .......... .......... .......... .......... 94% 67.3M 0s\n  7850K .......... .......... .......... .......... .......... 94% 67.3M 0s\n  7900K .......... .......... .......... .......... .......... 95% 74.5M 0s\n  7950K .......... .......... .......... .......... .......... 95% 65.7M 0s\n  8000K .......... .......... .......... .......... .......... 96% 66.9M 0s\n  8050K .......... .......... .......... .......... .......... 97% 74.5M 0s\n  8100K .......... .......... .......... .......... .......... 97% 65.9M 0s\n  8150K .......... .......... .......... .......... .......... 98% 65.7M 0s\n  8200K .......... .......... .......... .......... .......... 98% 74.5M 0s\n  8250K .......... .......... .......... .......... .......... 99% 66.0M 0s\n  8300K .......... .......... .......... ..........           100% 68.7M=0.1s\n\n2020-01-14 23:32:34 (72.2 MB/s) - ‘spark-cassandra-connector_2.11-2.4.0.jar’ saved [8540380/8540380]\n\n"}]},"apps":[],"jobName":"paragraph_1579247965387_2025327184","id":"20200114-233153_1281623588","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7973"},{"text":"%sh\ncat /etc/spark/conf/spark-env.sh","user":"anonymous","dateUpdated":"2020-01-17T07:59:25+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"#!/usr/bin/env bash\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nexport SPARK_HOME=${SPARK_HOME:-/usr/lib/spark}\nexport SPARK_LOG_DIR=${SPARK_LOG_DIR:-/var/log/spark}\nexport HADOOP_HOME=${HADOOP_HOME:-/usr/lib/hadoop}\nexport HADOOP_CONF_DIR=${HADOOP_CONF_DIR:-/etc/hadoop/conf}\nexport HIVE_CONF_DIR=${HIVE_CONF_DIR:-/etc/hive/conf}\n\nexport STANDALONE_SPARK_MASTER_HOST=ip-172-31-65-143.ec2.internal\nexport SPARK_MASTER_PORT=7077\nexport SPARK_MASTER_IP=$STANDALONE_SPARK_MASTER_HOST\nexport SPARK_MASTER_WEBUI_PORT=8080\n\nexport SPARK_WORKER_DIR=${SPARK_WORKER_DIR:-/var/run/spark/work}\nexport SPARK_WORKER_PORT=7078\nexport SPARK_WORKER_WEBUI_PORT=8081\n\nexport HIVE_SERVER2_THRIFT_BIND_HOST=0.0.0.0\nexport HIVE_SERVER2_THRIFT_PORT=10001\n\n\nexport SPARK_DAEMON_JAVA_OPTS=\"$SPARK_DAEMON_JAVA_OPTS -XX:OnOutOfMemoryError='kill -9 %p'\"\nexport SPARK_PUBLIC_DNS=ip-172-31-65-143.ec2.internal"}]},"apps":[],"jobName":"paragraph_1579247965389_-132604581","id":"20200115-000908_1069421124","dateCreated":"2020-01-17T07:59:25+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:7974"}],"name":"gdeltETL","id":"2F17JH4FE","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}