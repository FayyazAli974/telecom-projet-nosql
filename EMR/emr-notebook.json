{"paragraphs":[{"text":"%md\n## Jeu de donnees\nThe Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d'information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.\n\n\nCette base de données a eu beaucoup d'utilisations, par exemple pour mieux comprendre l'évolution et l'impact de la crise financière du 2008 (https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian dynamic financial networks with time-varying predictors]) ou analyser l'évolution des relations entre des pays impliquées dans des conflits (http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).\n\nGDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:\n\n* les events (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema], http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO Ontology], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* les mentions (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema], http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation])\n* le graph des relations => GKG, Global Knowledge Graph (https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema], http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation])\n\nL'ensemble des donnees _GDELT_ sont disponibles via HTTP. Un fichier CSV _masterfilelist.txt_\n(http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master CSV data file list]) nous permmet d'avoir la liste de tous les fichiers du jeu de donnees GDELT ainsi que l'URL pour telecharger chaque fichier.\n\n\nPour plus d'infos sur le format des fichiers vous pouvez consulter la documentation GDELT: https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\n","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Jeu de donnees</h2>\n<p>The Global Database of Events, Language, and Tone (*GDELT*), est une initiative pour construire un catalogue de comportements et de croyances sociales à travers le monde, reliant chaque personne, organisation, lieu, dénombrement, thème, source d&rsquo;information, et événement à travers la planète en un seul réseau massif qui capture ce qui se passe dans le monde, le contexte, les implications ainsi que la perception des gens sur chaque jour.</p>\n<p>Cette base de données a eu beaucoup d&rsquo;utilisations, par exemple pour mieux comprendre l&rsquo;évolution et l&rsquo;impact de la crise financière du 2008 (<a href=\"https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian\">https://arxiv.org/pdf/1403.2272v1.pdf[Bayesian</a> dynamic financial networks with time-varying predictors]) ou analyser l&rsquo;évolution des relations entre des pays impliquées dans des conflits (<a href=\"http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive\">http://www.gao.ece.ufl.edu/GXU/fun_reading/sbp_hurst.pdf[Massive</a> Media Event Data Analysis to Assess World-Wide Political Conflict and Instability] ).</p>\n<p>GDELT est compose par trois jeux de fichiers CSV, avec un fichier compressé par tranche de 15 minutes:</p>\n<ul>\n  <li>les events (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.events?tab=schema[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO\">http://data.gdeltproject.org/documentation/CAMEO.Manual.1.1b3.pdf[CAMEO</a> Ontology], <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>les mentions (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.eventmentions[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Event_Codebook-V2.0.pdf[documentation]</a>)</li>\n  <li>le graph des relations =&gt; GKG, Global Knowledge Graph (<a href=\"https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]\">https://bigquery.cloud.google.com/table/gdelt-bq:gdeltv2.gkg[schema]</a>, <a href=\"http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]\">http://data.gdeltproject.org/documentation/GDELT-Global_Knowledge_Graph_Codebook-V2.1.pdf[documentation]</a>)</li>\n</ul>\n<p>L&rsquo;ensemble des donnees <em>GDELT</em> sont disponibles via HTTP. Un fichier CSV <em>masterfilelist.txt</em><br/>(<a href=\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master\">http://data.gdeltproject.org/gdeltv2/masterfilelist.txt[Master</a> CSV data file list]) nous permmet d&rsquo;avoir la liste de tous les fichiers du jeu de donnees GDELT ainsi que l&rsquo;URL pour telecharger chaque fichier.</p>\n<p>Pour plus d&rsquo;infos sur le format des fichiers vous pouvez consulter la documentation GDELT: <a href=\"https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\">https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/</a></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175892_-1598481529","id":"20181212-100610_115068599","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:19515"},{"text":"import spark.implicits._\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection \nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"2020-01-21T12:41:44+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport sys.process._\nimport java.net.URL\nimport java.io.File\nimport java.io.File\nimport java.nio.file.{Files, StandardCopyOption}\nimport java.net.HttpURLConnection\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1579606198769_-480628673","id":"20200121-112958_1521496419","dateCreated":"2020-01-21T11:29:58+0000","dateStarted":"2020-01-21T12:41:44+0000","dateFinished":"2020-01-21T12:42:26+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19516"},{"text":"%sh\nifconfig","user":"anonymous","dateUpdated":"2020-01-21T12:40:10+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"eth0      Link encap:Ethernet  HWaddr 02:55:35:86:86:A1  \n          inet addr:172.31.15.105  Bcast:172.31.15.255  Mask:255.255.240.0\n          inet6 addr: fe80::55:35ff:fe86:86a1/64 Scope:Link\n          UP BROADCAST RUNNING MULTICAST  MTU:9001  Metric:1\n          RX packets:1362017 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:553449 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:1790073268 (1.6 GiB)  TX bytes:913806194 (871.4 MiB)\n\nlo        Link encap:Local Loopback  \n          inet addr:127.0.0.1  Mask:255.0.0.0\n          inet6 addr: ::1/128 Scope:Host\n          UP LOOPBACK RUNNING  MTU:65536  Metric:1\n          RX packets:681028 errors:0 dropped:0 overruns:0 frame:0\n          TX packets:681028 errors:0 dropped:0 overruns:0 carrier:0\n          collisions:0 txqueuelen:1000 \n          RX bytes:105338913 (100.4 MiB)  TX bytes:105338913 (100.4 MiB)\n\n"}]},"apps":[],"jobName":"paragraph_1579610406327_-256381198","id":"20200121-124006_664856967","dateCreated":"2020-01-21T12:40:06+0000","dateStarted":"2020-01-21T12:40:10+0000","dateFinished":"2020-01-21T12:40:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19517"},{"text":"%md\n## Chargement du fichier master dans S3","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Chargement du fichier master dans S3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175905_824407211","id":"20200117-090515_593668969","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19518"},{"text":"def fileDownloader(urlOfFileToDownload: String, fileName: String) = {\n    val url = new URL(urlOfFileToDownload)\n    val connection = url.openConnection().asInstanceOf[HttpURLConnection]\n    connection.setConnectTimeout(5000)\n    connection.setReadTimeout(5000)\n    connection.connect()\n\n    if (connection.getResponseCode >= 400)\n        println(\"error\")\n    else\n        url #> new File(fileName) !!\n}","user":"anonymous","dateUpdated":"2020-01-21T11:31:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one feature warning; re-run with -feature for details\nfileDownloader: (urlOfFileToDownload: String, fileName: String)Any\n"}]},"apps":[],"jobName":"paragraph_1579606175906_-1150032418","id":"20181209-161931_737140067","dateCreated":"2020-01-21T11:29:35+0000","dateStarted":"2020-01-21T11:31:23+0000","dateFinished":"2020-01-21T11:31:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19519"},{"text":"%md\nOn peut tester cette function pour telecharger en local le *masterfilelist* GDELT. Sur quelle machine ce fichier sera stocque ? ","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut tester cette function pour telecharger en local le <em>masterfilelist</em> GDELT. Sur quelle machine ce fichier sera stocque ?</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175906_-1297870238","id":"20181212-101024_1671681559","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19520"},{"text":"fileDownloader(\"http://data.gdeltproject.org/gdeltv2/masterfilelist.txt\", \"/mnt/tmp/masterfilelist.txt\") // save the list file to the Spark Master","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res1: Any = \"\"\n"}]},"apps":[],"jobName":"paragraph_1579606175907_1261084753","id":"20181209-162121_1695304399","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19521"},{"text":"%md\nOn peut verifier que le fichier a bien ete telecharge","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>On peut verifier que le fichier a bien ete telecharge</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175907_-1018744714","id":"20181212-101108_352331024","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19522"},{"text":"%sh\nls -lrth /mnt/tmp |grep masterfilelist","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"-rw-r--r--  1 zeppelin zeppelin  53M Jan 20 20:35 masterfilelist.txt\n"}]},"apps":[],"jobName":"paragraph_1579606175908_-2000062276","id":"20181210-111357_801203770","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19523"},{"text":"// Le code commenté est le code donné en cours. Il ne fonctionne pas, car il se base sur un ID et une clé AWS, d'un utilisateur qu'on devrait créer mais qu'on ne peut pas avec nos comptes educate. \n// Mettre l'id et la clé de notre compte root ne fonctionne pas non plus (je ne sais pas pourquoi). Le code non commenté fonctionne. Je pense que ce code utilise les infos de connexions du role que l'on utilise \n// actuellement (EMR_EC2_DefaultRole), et ce rôle a bien accès à S3, ou sinon de l'utilisateur root\n\n//import com.amazonaws.services.s3.AmazonS3Client\n//import com.amazonaws.auth.BasicAWSCredentials\n//import com.amazonaws.auth.DefaultAWSCredentialsProviderChain\n\n//val AWS_ID = \"ASIAZTSUL2OZIHFCANP5\"\n//val AWS_KEY = \"mS5tG/o8eWH12dtkkF9aeYuy3ZGar9rz4n6Q1zz8\"\n// la classe AmazonS3Client n'est pas serializable\n// on rajoute l'annotation @transient pour dire a Spark de ne pas essayer de serialiser cette classe et l'envoyer aux executeurs\n//@transient val awsClient = new AmazonS3Client(new BasicAWSCredentials(AWS_ID, AWS_KEY))\n\n//sc.hadoopConfiguration.set(\"fs.s3a.access.key\", AWS_ID) // mettre votre ID du fichier credentials.csv\n//sc.hadoopConfiguration.set(\"fs.s3a.secret.key\", AWS_KEY) // mettre votre secret du fichier credentials.csv\n\n\nimport com.amazonaws.services.s3.AmazonS3ClientBuilder\nimport com.amazonaws.services.s3.AmazonS3;\n\n@transient val awsClient = AmazonS3ClientBuilder.standard().withRegion(\"us-east-1\").build();\nawsClient.putObject(\"inf728-projet\", \"masterfilelist.txt\", new File( \"/mnt/tmp/masterfilelist.txt\") )\n","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.amazonaws.services.s3.AmazonS3ClientBuilder\nimport com.amazonaws.services.s3.AmazonS3\nawsClient: com.amazonaws.services.s3.AmazonS3 = com.amazonaws.services.s3.AmazonS3Client@646feb91\nres2: com.amazonaws.services.s3.model.PutObjectResult = com.amazonaws.services.s3.model.PutObjectResult@bf08e3e\n"}]},"apps":[],"jobName":"paragraph_1579606175908_-1274267343","id":"20181212-095117_1356104178","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19524"},{"text":"%md Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Verifions que le fichier a bien ete uploade dans le bucket S3 via un dataframe Spark</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175909_-592226601","id":"20181212-101258_954978327","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19525"},{"text":"import org.apache.spark.sql.SQLContext\n\nval sqlContext = new SQLContext(sc)\nval filesDF = sqlContext.read.\n                    option(\"delimiter\",\" \").\n                    option(\"infer_schema\",\"true\").\n                    csv(\"s3://inf728-projet/masterfilelist.txt\").\n                    withColumnRenamed(\"_c0\",\"size\").\n                    withColumnRenamed(\"_c1\",\"hash\").\n                    withColumnRenamed(\"_c2\",\"url\").\n                    cache","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport org.apache.spark.sql.SQLContext\nsqlContext: org.apache.spark.sql.SQLContext = org.apache.spark.sql.SQLContext@d581c2a\nfilesDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1579606175909_273066272","id":"20181209-163052_14263535","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19526"},{"text":"filesDF.show(false)","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------------------+--------------------------------------------------------------------+\n|size    |hash                            |url                                                                 |\n+--------+--------------------------------+--------------------------------------------------------------------+\n|150383  |297a16b493de7cf6ca809a7cc31d0b93|http://data.gdeltproject.org/gdeltv2/20150218230000.export.CSV.zip  |\n|318084  |bb27f78ba45f69a17ea6ed7755e9f8ff|http://data.gdeltproject.org/gdeltv2/20150218230000.mentions.CSV.zip|\n|10768507|ea8dde0beb0ba98810a92db068c0ce99|http://data.gdeltproject.org/gdeltv2/20150218230000.gkg.csv.zip     |\n|149211  |2a91041d7e72b0fc6a629e2ff867b240|http://data.gdeltproject.org/gdeltv2/20150218231500.export.CSV.zip  |\n|339037  |dec3f427076b716a8112b9086c342523|http://data.gdeltproject.org/gdeltv2/20150218231500.mentions.CSV.zip|\n|10269336|2f1a504a3c4558694ade0442e9a5ae6f|http://data.gdeltproject.org/gdeltv2/20150218231500.gkg.csv.zip     |\n|149723  |12268e821823aae2da90882621feda18|http://data.gdeltproject.org/gdeltv2/20150218233000.export.CSV.zip  |\n|357229  |744acad14559f2781a8db67715d63872|http://data.gdeltproject.org/gdeltv2/20150218233000.mentions.CSV.zip|\n|11279827|66b03e2efd7d51dabf916b1666910053|http://data.gdeltproject.org/gdeltv2/20150218233000.gkg.csv.zip     |\n|158842  |a5298ce3c6df1a8a759c61b5c0b6f8bb|http://data.gdeltproject.org/gdeltv2/20150218234500.export.CSV.zip  |\n|374528  |dd322c888f28311aca2c735468405551|http://data.gdeltproject.org/gdeltv2/20150218234500.mentions.CSV.zip|\n|11212939|cd20f295649b214dd16666ca451b9994|http://data.gdeltproject.org/gdeltv2/20150218234500.gkg.csv.zip     |\n|362610  |c4268d558bb22c02b3c132c17818c68b|http://data.gdeltproject.org/gdeltv2/20150219000000.export.CSV.zip  |\n|287807  |e7f464a7a451ad2af6e9c8fa24f0ccea|http://data.gdeltproject.org/gdeltv2/20150219000000.mentions.CSV.zip|\n|9728953 |8f4b26e134bd6605cce2d32e92e5d3d7|http://data.gdeltproject.org/gdeltv2/20150219000000.gkg.csv.zip     |\n|251605  |7685a6c71f010918f3be0d4ed2be977e|http://data.gdeltproject.org/gdeltv2/20150219001500.export.CSV.zip  |\n|263793  |e23ee65a60a1577dc74b979a54da406e|http://data.gdeltproject.org/gdeltv2/20150219001500.mentions.CSV.zip|\n|9459370 |6031464dfdcb331551d491916d400c18|http://data.gdeltproject.org/gdeltv2/20150219001500.gkg.csv.zip     |\n|255259  |f41066efb05d4024fca9dc1c2c6b9112|http://data.gdeltproject.org/gdeltv2/20150219003000.export.CSV.zip  |\n|308019  |061133d1efd29c66c7ecba0d52063927|http://data.gdeltproject.org/gdeltv2/20150219003000.mentions.CSV.zip|\n+--------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579606175910_-570046222","id":"20181209-185148_142944415","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19527"},{"text":"%md\n## Chargement des fichiers d'une journée dans S3","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Chargement des fichiers d&rsquo;une journée dans S3</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175910_-1881926457","id":"20200117-090921_1088801383","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19528"},{"text":"%md Par la suite on va charger uniquement les fichiers qui correspondent a la journee du 1er decembre 2018","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Par la suite on va charger uniquement les fichiers qui correspondent a la journee du 1er decembre 2018</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175911_-1304873874","id":"20181212-101345_616653479","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19529"},{"text":"val sampleDF = filesDF.filter(col(\"url\").contains(\"/20181201\")).cache\n","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"sampleDF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [size: string, hash: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1579606175911_1116185630","id":"20181209-162427_816541907","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19530"},{"text":"sampleDF.show(false)","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+--------------------------------+--------------------------------------------------------------------+\n|size    |hash                            |url                                                                 |\n+--------+--------------------------------+--------------------------------------------------------------------+\n|286749  |7745b74ca805d90a86a19909a67e410a|http://data.gdeltproject.org/gdeltv2/20181201000000.export.CSV.zip  |\n|249784  |95ea33b0393a85214eebfa58a02ceb38|http://data.gdeltproject.org/gdeltv2/20181201000000.mentions.CSV.zip|\n|9694304 |c0a3d85a1f3a5263b4c9f7ee1aa632f7|http://data.gdeltproject.org/gdeltv2/20181201000000.gkg.csv.zip     |\n|250319  |47317d0bd9cd56e7b96732677a918435|http://data.gdeltproject.org/gdeltv2/20181201001500.export.CSV.zip  |\n|304863  |37513cccbabc99a9e50a36dc8a590cb6|http://data.gdeltproject.org/gdeltv2/20181201001500.mentions.CSV.zip|\n|10119350|50c3fa1e60385a2ca1314af48dfbad4f|http://data.gdeltproject.org/gdeltv2/20181201001500.gkg.csv.zip     |\n|224825  |8ca8b3a6b4ff6a960b8db5ac8eb9174a|http://data.gdeltproject.org/gdeltv2/20181201003000.export.CSV.zip  |\n|298101  |68369aec62706a2b5a3752d2d725caa9|http://data.gdeltproject.org/gdeltv2/20181201003000.mentions.CSV.zip|\n|9705075 |8cd7aa2af725aa02b42412e0944cfe26|http://data.gdeltproject.org/gdeltv2/20181201003000.gkg.csv.zip     |\n|191077  |906e6599092855ba2965fe59fce70062|http://data.gdeltproject.org/gdeltv2/20181201004500.export.CSV.zip  |\n|252312  |de9048e047049b3b6ac86c0029caeb9c|http://data.gdeltproject.org/gdeltv2/20181201004500.mentions.CSV.zip|\n|9370422 |5a674db2a8d110d27753b97617431688|http://data.gdeltproject.org/gdeltv2/20181201004500.gkg.csv.zip     |\n|187888  |cee25cd1ab712b7ac4e2538c48353f21|http://data.gdeltproject.org/gdeltv2/20181201010000.export.CSV.zip  |\n|274338  |e12ffacb37d73d9c9470a93032a50f41|http://data.gdeltproject.org/gdeltv2/20181201010000.mentions.CSV.zip|\n|10008236|48764cfe5bc415441ed34b4b5a1b0372|http://data.gdeltproject.org/gdeltv2/20181201010000.gkg.csv.zip     |\n|145719  |df1010eb1a3466fef5c9a5b89368328c|http://data.gdeltproject.org/gdeltv2/20181201011500.export.CSV.zip  |\n|255772  |781fffb723e8b5595fc08517ccc6c91b|http://data.gdeltproject.org/gdeltv2/20181201011500.mentions.CSV.zip|\n|8933180 |e1fa1f13da14b85e2ba31c35cbbac8b1|http://data.gdeltproject.org/gdeltv2/20181201011500.gkg.csv.zip     |\n|133461  |1bcaee75fe0a316dac205752030a05e5|http://data.gdeltproject.org/gdeltv2/20181201013000.export.CSV.zip  |\n|246396  |2c9bac79d58fc5a141651ddc072d0cd6|http://data.gdeltproject.org/gdeltv2/20181201013000.mentions.CSV.zip|\n+--------+--------------------------------+--------------------------------------------------------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579606175911_-1844741835","id":"20181209-184529_2045997321","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19531"},{"text":"%md Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Nous allons charger tous ces fichiers dans le bucket S3 via un ETL Spark:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175912_57078140","id":"20181212-101426_1390220831","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19532"},{"text":"import com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\n\nobject AwsClient{\n    val s3 = new AmazonS3Client()\n}\n\n\nsampleDF.select(\"url\").repartition(100).foreach( r=> {\n            val URL = r.getAs[String](0)\n            val fileName = r.getAs[String](0).split(\"/\").last\n            val dir = \"/mnt/tmp/\"\n            val localFileName = dir + fileName\n            fileDownloader(URL,  localFileName)\n            val localFile = new File(localFileName)\n            AwsClient.s3.putObject(\"inf728-projet/data\", fileName, localFile )\n            //awsClient.putObject(\"inf728-projet\", fileName, localFile )\n            localFile.delete()\n})","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nimport com.amazonaws.services.s3.AmazonS3Client\nimport com.amazonaws.auth.BasicAWSCredentials\ndefined object AwsClient\n"}]},"apps":[],"jobName":"paragraph_1579606175913_1934270345","id":"20181209-163933_1336720866","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19533"},{"text":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n\nval textRDD = sc.binaryFiles(\"s3://inf728-projet/data/20181201[0-9]*.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n\ntextRDD.take(1)","user":"anonymous","dateUpdated":"2020-01-21T11:31:47+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\ntextRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[1] at flatMap at <console>:46\nres1: Array[String] = Array(806754250\t20171201\t201712\t2017\t2017.9068\t\t\t\t\t\t\t\t\t\t\tUSA\tUNITED STATES\tUSA\t\t\t\t\t\t\t\t1\t100\t100\t10\t3\t-5.0\t4\t1\t4\t-0.66666666666667\t0\t\t\t\t\t\t\t\t3\tNew Haven, Connecticut, United States\tUS\tUSCT\t\t41.3082\t-72.9282\t209231\t3\tNew Haven, Connecticut, United States\tUS\tUSCT\t\t41.3082\t-72.9282\t209231\t20181201000000\thttps://bismarcktribune.com/news/national/the-latest-immigrant-s-supporters-end-courthouse-protest/article_76d71ef6-d0e0-5e02-ab72-4c8a0d31778e.html)\n"}]},"apps":[],"jobName":"paragraph_1579606175914_-502001814","id":"20200117-093634_466317294","dateCreated":"2020-01-21T11:29:35+0000","dateStarted":"2020-01-21T11:31:47+0000","dateFinished":"2020-01-21T11:31:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19534"},{"text":"// Convert textRDD to dataframe\nval arrays = textRDD.map(_.split(\"\\t\")) \nval maxCols = arrays.first().length\nval textDF = arrays.toDF(\"arr\")\n  .select((0 until maxCols).map(i => $\"arr\"(i).as(s\"col_$i\")): _*)\n\ntextDF.show()","user":"anonymous","dateUpdated":"2020-01-21T11:31:59+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\n|    col_0|   col_1| col_2|col_3|    col_4| col_5|        col_6|col_7|col_8|col_9|col_10|col_11|col_12|col_13|col_14|col_15|       col_16|col_17|col_18|col_19|col_20|col_21|col_22|col_23|col_24|col_25|col_26|col_27|col_28|col_29|col_30|col_31|col_32|col_33|           col_34|col_35|              col_36|col_37|col_38|col_39|  col_40|  col_41|  col_42|col_43|              col_44|col_45|col_46|col_47|  col_48|  col_49|  col_50|col_51|              col_52|col_53|col_54|col_55|  col_56|  col_57|  col_58|        col_59|              col_60|\n+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\n|806754250|20171201|201712| 2017|2017.9068|      |             |     |     |     |      |      |      |      |      |   USA|UNITED STATES|   USA|      |      |      |      |      |      |      |     1|   100|   100|    10|     3|  -5.0|     4|     1|     4|-0.66666666666667|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754251|20171201|201712| 2017|2017.9068|      |             |     |     |     |      |      |      |      |      |   USA|UNITED STATES|   USA|      |      |      |      |      |      |      |     1|   174|   174|    17|     4|  -5.0|     4|     1|     4|-0.66666666666667|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754252|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     1|     1|     1|-3.40091563113146|     4|Malvinas, TucumáA...|    AR|  AR24|  4883|-26.9167|-65.2833|-1003014|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://www.nbcmi...|\n|806754253|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     3|     3|     3|-2.98160973367665|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|20181201000000|https://m.lasvega...|\n|806754254|20171201|201712| 2017|2017.9068|   ARG|    ARGENTINA|  ARG|     |     |      |      |      |      |      |   DEU|      HAMBURG|   DEU|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     2|     2|     2|-2.77195678494925|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://m.lasvega...|\n|806754255|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   FRA|       FRANCE|   FRA|      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     4|     1|     4|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|              France|    FR|    FR|      |      46|       2|      FR|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754256|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   FRA|       FRANCE|   FRA|      |      |      |      |      |      |      |     1|   173|   173|    17|     4|  -5.0|     4|     1|     4|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|              France|    FR|    FR|      |      46|       2|      FR|     1|              France|    FR|    FR|      |      46|       2|      FR|20181201000000|https://www.stuff...|\n|806754257|20171201|201712| 2017|2017.9068|   AUS|       SYDNEY|  AUS|     |     |      |      |      |      |      |   GBR|      BRITAIN|   GBR|      |      |      |      |      |      |      |     1|   042|   042|    04|     1|   1.9|     6|     1|     6|-6.80272108843537|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     1|      United Kingdom|    UK|    UK|      |      54|      -4|      UK|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754258|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     3|     3|     3|-2.98160973367665|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Hamburg, Hamburg,...|    GM|  GM04| 40698|   53.55|      10|-1785434|20181201000000|https://m.lasvega...|\n|806754259|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     1|     1|     1|-3.40091563113146|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Malvinas, TucumáA...|    AR|  AR24|  4883|-26.9167|-65.2833|-1003014|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://www.nbcmi...|\n|806754260|20171201|201712| 2017|2017.9068|   DEU|      HAMBURG|  DEU|     |     |      |      |      |      |      |   ARG|    ARGENTINA|   ARG|      |      |      |      |      |      |      |     0|   036|   036|    03|     1|   4.0|     2|     2|     2|-2.77195678494925|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|     4|Buenos Aires, Dis...|    AR|  AR07| 22379|-34.5875|-58.6725| -979186|20181201000000|https://m.lasvega...|\n|806754261|20171201|201712| 2017|2017.9068|   FRA|       FRANCE|  FRA|     |     |      |      |      |      |      |   AUS|       SYDNEY|   AUS|      |      |      |      |      |      |      |     1|   042|   042|    04|     1|   1.9|     4|     1|     4|-6.80272108843537|     1|              France|    FR|    FR|      |      46|       2|      FR|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754262|20171201|201712| 2017|2017.9068|   GBR|      BRITAIN|  GBR|     |     |      |      |      |      |      |   AUS|       SYDNEY|   AUS|      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     6|     1|     6|-6.80272108843537|     1|      United Kingdom|    UK|    UK|      |      54|      -4|      UK|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|     4|Sydney, New South...|    AS|  AS02|154637|-33.8833| 151.217|-1603135|20181201000000|https://www.stuff...|\n|806754263|20171201|201712| 2017|2017.9068|MEXGOV|      MEXICAN|  MEX|     |     |      |      |   GOV|      |      |   EDU|      COLLEGE|      |      |      |      |      |   EDU|      |      |     0|   173|   173|    17|     4|  -5.0|     3|     1|     3|-7.66961651917404|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|20181201000000|https://napavalle...|\n|806754264|20171201|201712| 2017|2017.9068|MEXGOV|       MEXICO|  MEX|     |     |      |      |   GOV|      |      |   MEX|       MEXICO|   MEX|      |      |      |      |      |      |      |     0|   173|   173|    17|     4|  -5.0|     1|     1|     1|-7.66961651917404|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|     4|Mexico City, Dist...|    MX|  MX09| 20887| 19.4342|-99.1386|-1658079|20181201000000|https://napavalle...|\n|806754265|20171201|201712| 2017|2017.9068|MEXGOV|       MEXICO|  MEX|     |     |      |      |   GOV|      |      |   MEX|       MEXICO|   MEX|      |      |      |      |      |      |      |     0|   173|   173|    17|     4|  -5.0|     1|     1|     1|-7.66961651917404|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|     4|Sinaloa, Tabasco,...|    MX|  MX27|      | 18.4917|  -93.75| 6226960|20181201000000|https://napavalle...|\n|806754266|20171201|201712| 2017|2017.9068|   RUS|       RUSSIA|  RUS|     |     |      |      |      |      |      |LEGSPY|       SENATE|      |      |      |      |      |   LEG|   SPY|      |     1|   010|   010|    01|     1|   0.0|     2|     1|     2|-3.69068541300527|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|     4|Moscow, Moskva, R...|    RS|  RS48| 25106| 55.7522| 37.6156|-2960561|20181201000000|https://www.europ...|\n|806754267|20171201|201712| 2017|2017.9068|   USA| JACKSONVILLE|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     1|   043|   043|    04|     1|   2.8|     5|     1|     5|-1.09589041095891|     3|Jacksonville, Flo...|    US|  USFL| FL031| 30.3322|-81.6556|  295003|     0|                    |      |      |      |        |        |        |     2|Michigan, United ...|    US|  USMI|      | 43.3504|-84.5603|      MI|20181201000000|https://www.actio...|\n|806754268|20171201|201712| 2017|2017.9068|   USA|UNITED STATES|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     0|   100|   100|    10|     3|  -5.0|     4|     1|     4|-0.66666666666667|     3|New Haven, Connec...|    US|  USCT| CT009| 41.3082|-72.9282|  209231|     0|                    |      |      |      |        |        |        |     3|New Haven, Connec...|    US|  USCT|      | 41.3082|-72.9282|  209231|20181201000000|https://bismarckt...|\n|806754269|20171201|201712| 2017|2017.9068|   USA|UNITED STATES|  USA|     |     |      |      |      |      |      |      |             |      |      |      |      |      |      |      |      |     1|   129|   129|    12|     3|  -5.0|     4|     1|     4| 0.32467532467533|     2|South Carolina, U...|    US|  USSC|      | 33.8191|-80.9066|      SC|     0|                    |      |      |      |        |        |        |     2|South Carolina, U...|    US|  USSC|      | 33.8191|-80.9066|      SC|20181201000000|https://www.south...|\n+---------+--------+------+-----+---------+------+-------------+-----+-----+-----+------+------+------+------+------+------+-------------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+------+-----------------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+------+--------------------+------+------+------+--------+--------+--------+--------------+--------------------+\nonly showing top 20 rows\n\narrays: org.apache.spark.rdd.RDD[Array[String]] = MapPartitionsRDD[2] at map at <console>:45\nmaxCols: Int = 61\ntextDF: org.apache.spark.sql.DataFrame = [col_0: string, col_1: string ... 59 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579606175914_819720978","id":"20200117-103844_729873588","dateCreated":"2020-01-21T11:29:35+0000","dateStarted":"2020-01-21T11:31:59+0000","dateFinished":"2020-01-21T11:32:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19535"},{"text":"val newNames = Seq(\"test1\", \"test2\", \"test3\")\nval textDF_R1 = textDF.select(\"col_0\", \"col_1\", \"col_2\").toDF(newNames: _*)\ntextDF_R1.show()","user":"anonymous","dateUpdated":"2020-01-21T11:38:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------+------+\n|    test1|   test2| test3|\n+---------+--------+------+\n|806754250|20171201|201712|\n|806754251|20171201|201712|\n|806754252|20171201|201712|\n|806754253|20171201|201712|\n|806754254|20171201|201712|\n|806754255|20171201|201712|\n|806754256|20171201|201712|\n|806754257|20171201|201712|\n|806754258|20171201|201712|\n|806754259|20171201|201712|\n|806754260|20171201|201712|\n|806754261|20171201|201712|\n|806754262|20171201|201712|\n|806754263|20171201|201712|\n|806754264|20171201|201712|\n|806754265|20171201|201712|\n|806754266|20171201|201712|\n|806754267|20171201|201712|\n|806754268|20171201|201712|\n|806754269|20171201|201712|\n+---------+--------+------+\nonly showing top 20 rows\n\nnewNames: Seq[String] = List(test1, test2, test3)\ntextDF_R1: org.apache.spark.sql.DataFrame = [test1: string, test2: string ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1579606524592_1840030070","id":"20200121-113524_1714006000","dateCreated":"2020-01-21T11:35:24+0000","dateStarted":"2020-01-21T11:38:32+0000","dateFinished":"2020-01-21T11:38:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19536"},{"text":"%md\n## Remplissage des tables Cassandra","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Remplissage des tables Cassandra</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175916_-1258267546","id":"20200117-093543_438964787","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19537"},{"text":"// Imports\nimport org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.types.IntegerType","user":"anonymous","dateUpdated":"2020-01-21T12:41:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport org.apache.spark.sql.SQLContext\nimport org.apache.spark.sql.cassandra._\nimport com.datastax.spark.connector._\nimport org.apache.spark.sql.types.IntegerType\n"}]},"apps":[],"jobName":"paragraph_1579608790795_-145080058","id":"20200121-121310_506217352","dateCreated":"2020-01-21T12:13:10+0000","dateStarted":"2020-01-21T12:42:00+0000","dateFinished":"2020-01-21T12:42:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:19538"},{"text":"val df_R1 = spark.read.cassandraFormat(\"table1\", \"gdelt_space\").load()","user":"anonymous","dateUpdated":"2020-01-21T12:42:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.io.IOException: Failed to open native connection to Cassandra at {172.31.92.67}:9042\n  at com.datastax.spark.connector.cql.CassandraConnector$.com$datastax$spark$connector$cql$CassandraConnector$$createSession(CassandraConnector.scala:168)\n  at com.datastax.spark.connector.cql.CassandraConnector$$anonfun$8.apply(CassandraConnector.scala:154)\n  at com.datastax.spark.connector.cql.CassandraConnector$$anonfun$8.apply(CassandraConnector.scala:154)\n  at com.datastax.spark.connector.cql.RefCountedCache.createNewValueAndKeys(RefCountedCache.scala:32)\n  at com.datastax.spark.connector.cql.RefCountedCache.syncAcquire(RefCountedCache.scala:69)\n  at com.datastax.spark.connector.cql.RefCountedCache.acquire(RefCountedCache.scala:57)\n  at com.datastax.spark.connector.cql.CassandraConnector.openSession(CassandraConnector.scala:79)\n  at com.datastax.spark.connector.cql.CassandraConnector.withSessionDo(CassandraConnector.scala:111)\n  at com.datastax.spark.connector.rdd.partitioner.dht.TokenFactory$.forSystemLocalPartitioner(TokenFactory.scala:98)\n  at org.apache.spark.sql.cassandra.CassandraSourceRelation$.apply(CassandraSourceRelation.scala:272)\n  at org.apache.spark.sql.cassandra.DefaultSource.createRelation(DefaultSource.scala:56)\n  at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:318)\n  at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:223)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:211)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:167)\n  ... 58 elided\nCaused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: ip-172-31-92-67.ec2.internal/172.31.92.67:9042 (com.datastax.driver.core.exceptions.TransportException: [ip-172-31-92-67.ec2.internal/172.31.92.67:9042] Cannot connect))\n  at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:233)\n  at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:79)\n  at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1483)\n  at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:399)\n  at com.datastax.spark.connector.cql.CassandraConnector$.com$datastax$spark$connector$cql$CassandraConnector$$createSession(CassandraConnector.scala:161)\n  ... 72 more\n"}]},"apps":[],"jobName":"paragraph_1579608198868_-893962000","id":"20200121-120318_1117157015","dateCreated":"2020-01-21T12:03:18+0000","dateStarted":"2020-01-21T12:42:27+0000","dateFinished":"2020-01-21T12:42:37+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:19539"},{"text":"val readBooksDF = sqlContext\n  .read\n  .format(\"org.apache.spark.sql.cassandra\")\n  .options(Map( \"table\" -> \"table1\", \"keyspace\" -> \"gdelt_space\"))\n  .load\n\nreadBooksDF.explain\nreadBooksDF.show","user":"anonymous","dateUpdated":"2020-01-21T12:28:18+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"java.io.IOException: Failed to open native connection to Cassandra at {172.31.89.119}:9042\n  at com.datastax.spark.connector.cql.CassandraConnector$.com$datastax$spark$connector$cql$CassandraConnector$$createSession(CassandraConnector.scala:168)\n  at com.datastax.spark.connector.cql.CassandraConnector$$anonfun$8.apply(CassandraConnector.scala:154)\n  at com.datastax.spark.connector.cql.CassandraConnector$$anonfun$8.apply(CassandraConnector.scala:154)\n  at com.datastax.spark.connector.cql.RefCountedCache.createNewValueAndKeys(RefCountedCache.scala:32)\n  at com.datastax.spark.connector.cql.RefCountedCache.syncAcquire(RefCountedCache.scala:69)\n  at com.datastax.spark.connector.cql.RefCountedCache.acquire(RefCountedCache.scala:57)\n  at com.datastax.spark.connector.cql.CassandraConnector.openSession(CassandraConnector.scala:79)\n  at com.datastax.spark.connector.cql.CassandraConnector.withSessionDo(CassandraConnector.scala:111)\n  at com.datastax.spark.connector.rdd.partitioner.dht.TokenFactory$.forSystemLocalPartitioner(TokenFactory.scala:98)\n  at org.apache.spark.sql.cassandra.CassandraSourceRelation$.apply(CassandraSourceRelation.scala:272)\n  at org.apache.spark.sql.cassandra.DefaultSource.createRelation(DefaultSource.scala:56)\n  at org.apache.spark.sql.execution.datasources.DataSource.resolveRelation(DataSource.scala:318)\n  at org.apache.spark.sql.DataFrameReader.loadV1Source(DataFrameReader.scala:223)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:211)\n  at org.apache.spark.sql.DataFrameReader.load(DataFrameReader.scala:167)\n  ... 58 elided\nCaused by: com.datastax.driver.core.exceptions.NoHostAvailableException: All host(s) tried for query failed (tried: ip-172-31-89-119.ec2.internal/172.31.89.119:9042 (com.datastax.driver.core.exceptions.TransportException: [ip-172-31-89-119.ec2.internal/172.31.89.119:9042] Cannot connect))\n  at com.datastax.driver.core.ControlConnection.reconnectInternal(ControlConnection.java:233)\n  at com.datastax.driver.core.ControlConnection.connect(ControlConnection.java:79)\n  at com.datastax.driver.core.Cluster$Manager.init(Cluster.java:1483)\n  at com.datastax.driver.core.Cluster.getMetadata(Cluster.java:399)\n  at com.datastax.spark.connector.cql.CassandraConnector$.com$datastax$spark$connector$cql$CassandraConnector$$createSession(CassandraConnector.scala:161)\n  ... 72 more\n"}]},"apps":[],"jobName":"paragraph_1579608334720_-988034494","id":"20200121-120534_1603792660","dateCreated":"2020-01-21T12:05:34+0000","dateStarted":"2020-01-21T12:28:18+0000","dateFinished":"2020-01-21T12:28:27+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:19540"},{"text":"CREATE KEYSPACE gdelt_space WITH REPLICATION = { 'class' : 'SimpleStrategy', 'replication_factor' : 3 }; \nUSE gdelt_space;\nCREATE TABLE table1 (key text PRIMARY KEY, value text);\nINSERT INTO table1 (key,value) VALUES ('1', 'works');\nSELECT * from gdelt_space.table1;","user":"anonymous","dateUpdated":"2020-01-21T12:01:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579608027790_-851276755","id":"20200121-120027_2081364155","dateCreated":"2020-01-21T12:00:27+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:19541"},{"text":"textDF_R1.write.cassandraFormat(\"table1\", \"gdelt_space\").save() // table / keyspace\nval df_R1 = spark.read.cassandraFormat(\"table1\", \"gdelt_space\").load()","user":"anonymous","dateUpdated":"2020-01-21T11:47:14+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579607183590_-282233384","id":"20200121-114623_1057116754","dateCreated":"2020-01-21T11:46:23+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:19542"},{"text":"df_R1.createOrReplaceTempView(\"table1\")\nspark.sql(\"\"\"SELECT * FROM table1\"\"\")","user":"anonymous","dateUpdated":"2020-01-21T12:01:11+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579607015153_-1001103198","id":"20200121-114335_827760728","dateCreated":"2020-01-21T11:43:35+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:19543"},{"text":"","user":"anonymous","dateUpdated":"2020-01-21T11:46:49+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579606175921_-1732289856","id":"20200120-215823_1585378542","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19544"},{"text":"%cassandra\nCREATE TABLE table1(\naa int,\nbb text\nPRIMARY KEY (aa, bb));","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.zeppelin.interpreter.InterpreterNotFoundException: Either no interpreter named cassandra or it is not binded to this note"}]},"apps":[],"jobName":"paragraph_1579606175921_1649102561","id":"20200117-093839_1301683811","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19545"},{"text":"","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Must be used before SparkInterpreter (%spark) initialized\nHint: put this paragraph before any Spark code and restart Zeppelin/Interpreter"}]},"apps":[],"jobName":"paragraph_1579606175921_1746594591","id":"20200120-212120_135301996","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19546"},{"text":"%sh\npwd","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/var/lib/zeppelin\n"}]},"apps":[],"jobName":"paragraph_1579606175922_2028767009","id":"20200120-205319_36060207","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19547"},{"text":"%md\n## Brouillon","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Brouillon</h2>\n</div>"}]},"apps":[],"jobName":"paragraph_1579606175922_761749183","id":"20200117-093524_1044203784","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19548"},{"text":"%sh\naws s3 ls","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"2020-01-12 19:33:56 aws-logs-660528157618-us-east-1\n2020-01-19 12:45:55 inf728-projet\n"}]},"apps":[],"jobName":"paragraph_1579606175923_1198393098","id":"20200112-201437_442754611","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19549"},{"text":"%sh\naws sts get-caller-identity","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"{\n    \"Account\": \"660528157618\", \n    \"UserId\": \"AROAZTSUL2OZADPFFEGJV:i-0b49eca0e2e2dc6e5\", \n    \"Arn\": \"arn:aws:sts::660528157618:assumed-role/EMR_EC2_DefaultRole/i-0b49eca0e2e2dc6e5\"\n}\n"}]},"apps":[],"jobName":"paragraph_1579606175926_1702837037","id":"20200112-202950_1447155640","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19550"},{"text":"%sh\naws configure list","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"      Name                    Value             Type    Location\n      ----                    -----             ----    --------\n   profile                <not set>             None    None\naccess_key     ****************2AEV         iam-role    \nsecret_key     ****************Spj3         iam-role    \n    region                <not set>             None    None\n"}]},"apps":[],"jobName":"paragraph_1579606175927_-1482111736","id":"20200112-210411_232637861","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19551"},{"text":"%sh\nwget http://central.maven.org/maven2/com/datastax/spark/spark-cassandra-connector_2.11/2.4.0/spark-cassandra-connector_2.11-2.4.0.jar;","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"--2020-01-20 20:37:23--  http://central.maven.org/maven2/com/datastax/spark/spark-cassandra-connector_2.11/2.4.0/spark-cassandra-connector_2.11-2.4.0.jar\nResolving central.maven.org (central.maven.org)... 151.101.248.209\nConnecting to central.maven.org (central.maven.org)|151.101.248.209|:80... connected.\nHTTP request sent, awaiting response... 501 HTTPS Required\n2020-01-20 20:37:23 ERROR 501: HTTPS Required.\n\n"},{"type":"TEXT","data":"ExitValue: 8"}]},"apps":[],"jobName":"paragraph_1579606175927_546272128","id":"20200114-233153_1281623588","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19552"},{"text":"%sh\ncat /etc/spark/conf/spark-env.sh","user":"anonymous","dateUpdated":"2020-01-21T11:29:35+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"#!/usr/bin/env bash\n# Licensed to the Apache Software Foundation (ASF) under one or more\n# contributor license agreements.  See the NOTICE file distributed with\n# this work for additional information regarding copyright ownership.\n# The ASF licenses this file to You under the Apache License, Version 2.0\n# (the \"License\"); you may not use this file except in compliance with\n# the License.  You may obtain a copy of the License at\n#\n#     http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software\n# distributed under the License is distributed on an \"AS IS\" BASIS,\n# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n# See the License for the specific language governing permissions and\n# limitations under the License.\n\nexport SPARK_HOME=${SPARK_HOME:-/usr/lib/spark}\nexport SPARK_LOG_DIR=${SPARK_LOG_DIR:-/var/log/spark}\nexport HADOOP_HOME=${HADOOP_HOME:-/usr/lib/hadoop}\nexport HADOOP_CONF_DIR=${HADOOP_CONF_DIR:-/etc/hadoop/conf}\nexport HIVE_CONF_DIR=${HIVE_CONF_DIR:-/etc/hive/conf}\n\nexport STANDALONE_SPARK_MASTER_HOST=ip-172-31-65-143.ec2.internal\nexport SPARK_MASTER_PORT=7077\nexport SPARK_MASTER_IP=$STANDALONE_SPARK_MASTER_HOST\nexport SPARK_MASTER_WEBUI_PORT=8080\n\nexport SPARK_WORKER_DIR=${SPARK_WORKER_DIR:-/var/run/spark/work}\nexport SPARK_WORKER_PORT=7078\nexport SPARK_WORKER_WEBUI_PORT=8081\n\nexport HIVE_SERVER2_THRIFT_BIND_HOST=0.0.0.0\nexport HIVE_SERVER2_THRIFT_PORT=10001\n\n\nexport SPARK_DAEMON_JAVA_OPTS=\"$SPARK_DAEMON_JAVA_OPTS -XX:OnOutOfMemoryError='kill -9 %p'\"\nexport SPARK_PUBLIC_DNS=ip-172-31-65-143.ec2.internal"}]},"apps":[],"jobName":"paragraph_1579606175928_1151356693","id":"20200115-000908_1069421124","dateCreated":"2020-01-21T11:29:35+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:19553"}],"name":"emr-notebook","id":"2EYEX837Y","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"sh:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}